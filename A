--[[
    iLusiOS UI Library
    Uma biblioteca moderna de UI para Roblox com animações premium
    Uso: local UI = loadstring(game:HttpGet("seu_link_aqui"))()
]]

local iLusiOS = {}
iLusiOS.__index = iLusiOS

-- Serviços
local Players = game:GetService("Players")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Configurações padrão
local DefaultConfig = {
    Title = "iLusiOS",
    Size = UDim2.new(0, 438, 0, 274),
    MinSize = Vector2.new(300, 200),
    MaxSize = Vector2.new(600, 400),
    Position = UDim2.new(0.5, 0, 0.5, 0),
    Theme = {
        Background = Color3.fromRGB(20, 20, 25),
        Primary = Color3.fromRGB(100, 150, 255),
        Secondary = Color3.fromRGB(255, 100, 150),
        Text = Color3.fromRGB(255, 255, 255),
        Accent = Color3.fromRGB(150, 200, 255)
    }
}

-- Função auxiliar para criar gradientes animados
local function CreateAnimatedGradient(parent, colors, isButton)
    local gradient = Instance.new("UIGradient", parent)
    gradient.Color = ColorSequence.new(colors)
    gradient.Rotation = 0
    
    if isButton then
        local connection
        connection = RunService.Heartbeat:Connect(function(dt)
            if not parent or not parent.Parent then
                connection:Disconnect()
                return
            end
            gradient.Rotation = (gradient.Rotation + dt * 80) % 360
        end)
    end
    
    return gradient
end

-- Função auxiliar para criar brilho
local function CreateGlow(parent, color)
    local glow = Instance.new("ImageLabel", parent)
    glow.Name = "Glow"
    glow.Size = UDim2.new(1.4, 0, 1.4, 0)
    glow.Position = UDim2.new(0.5, 0, 0.5, 0)
    glow.AnchorPoint = Vector2.new(0.5, 0.5)
    glow.BackgroundTransparency = 1
    glow.Image = "rbxassetid://5028857084"
    glow.ImageColor3 = color
    glow.ImageTransparency = 0.3
    glow.ZIndex = 0
    
    return glow
end

-- Criar janela principal
function iLusiOS.new(config)
    local self = setmetatable({}, iLusiOS)
    
    -- Mesclar configurações
    self.Config = config or {}
    for k, v in pairs(DefaultConfig) do
        if self.Config[k] == nil then
            self.Config[k] = v
        end
    end
    
    -- Criar ScreenGui
    self.ScreenGui = Instance.new("ScreenGui")
    self.ScreenGui.Name = "iLusiOSLib"
    self.ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    self.ScreenGui.ResetOnSpawn = false
    self.ScreenGui.Parent = Players.LocalPlayer:WaitForChild("PlayerGui")
    
    -- Frame principal
    self.MainFrame = Instance.new("Frame", self.ScreenGui)
    self.MainFrame.Name = "MainWindow"
    self.MainFrame.BorderSizePixel = 0
    self.MainFrame.BackgroundColor3 = self.Config.Theme.Background
    self.MainFrame.Size = UDim2.new(0, 380, 0, 230)
    self.MainFrame.Position = self.Config.Position
    self.MainFrame.AnchorPoint = Vector2.new(0.5, 0.5)
    self.MainFrame.BackgroundTransparency = 1
    
    local corner = Instance.new("UICorner", self.MainFrame)
    corner.CornerRadius = UDim.new(0, 20)
    
    -- Drag detector
    local dragDetector = Instance.new("UIDragDetector", self.MainFrame)
    
    -- Barra de título
    self.TitleBar = Instance.new("Frame", self.MainFrame)
    self.TitleBar.Name = "TitleBar"
    self.TitleBar.Size = UDim2.new(1, 0, 0, 50)
    self.TitleBar.BackgroundTransparency = 1
    
    self.TitleLabel = Instance.new("TextLabel", self.TitleBar)
    self.TitleLabel.Name = "Title"
    self.TitleLabel.Size = UDim2.new(1, -120, 1, 0)
    self.TitleLabel.Position = UDim2.new(0, 20, 0, 0)
    self.TitleLabel.BackgroundTransparency = 1
    self.TitleLabel.Text = self.Config.Title
    self.TitleLabel.TextColor3 = self.Config.Theme.Text
    self.TitleLabel.Font = Enum.Font.GothamBold
    self.TitleLabel.TextSize = 18
    self.TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
    
    -- Container de conteúdo
    self.Content = Instance.new("ScrollingFrame", self.MainFrame)
    self.Content.Name = "Content"
    self.Content.Size = UDim2.new(1, -20, 1, -70)
    self.Content.Position = UDim2.new(0, 10, 0, 60)
    self.Content.BackgroundTransparency = 1
    self.Content.BorderSizePixel = 0
    self.Content.ScrollBarThickness = 4
    self.Content.ScrollBarImageColor3 = self.Config.Theme.Primary
    
    local listLayout = Instance.new("UIListLayout", self.Content)
    listLayout.Padding = UDim.new(0, 10)
    listLayout.SortOrder = Enum.SortOrder.LayoutOrder
    
    -- Botões de controle
    self:CreateControlButtons()
    
    -- Variáveis de tamanho
    self.CurrentSize = Vector2.new(self.Config.Size.X.Offset, self.Config.Size.Y.Offset)
    
    -- Animação de entrada
    self:AnimateOpen()
    
    -- Tabs
    self.Tabs = {}
    self.CurrentTab = nil
    
    return self
end

-- Criar botões de controle (aumentar/diminuir)
function iLusiOS:CreateControlButtons()
    -- Botão de aumentar (vermelho)
    local redButton = Instance.new("TextButton", self.TitleBar)
    redButton.Name = "ExpandButton"
    redButton.Size = UDim2.new(0, 30, 0, 30)
    redButton.Position = UDim2.new(1, -75, 0, 10)
    redButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    redButton.BorderSizePixel = 0
    redButton.Text = "+"
    redButton.TextColor3 = self.Config.Theme.Text
    redButton.Font = Enum.Font.GothamBold
    redButton.TextSize = 20
    redButton.TextStrokeTransparency = 0.5
    
    local redCorner = Instance.new("UICorner", redButton)
    redCorner.CornerRadius = UDim.new(1, 0)
    
    -- Gradiente vermelho
    local redGradient = CreateAnimatedGradient(redButton, {
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 50, 80)),
        ColorSequenceKeypoint.new(0.3, Color3.fromRGB(255, 100, 120)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 120, 140)),
        ColorSequenceKeypoint.new(0.7, Color3.fromRGB(255, 80, 100)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(200, 30, 60))
    }, true)
    
    local redGlow = CreateGlow(redButton, Color3.fromRGB(255, 50, 80))
    
    local redStroke = Instance.new("UIStroke", redButton)
    redStroke.Color = Color3.fromRGB(255, 100, 150)
    redStroke.Thickness = 2
    redStroke.Transparency = 0.3
    
    local redStrokeGradient = Instance.new("UIGradient", redStroke)
    redStrokeGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(255, 150, 180)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 150, 180))
    }
    
    -- Botão de diminuir (azul)
    local blueButton = Instance.new("TextButton", self.TitleBar)
    blueButton.Name = "ShrinkButton"
    blueButton.Size = UDim2.new(0, 30, 0, 30)
    blueButton.Position = UDim2.new(1, -35, 0, 10)
    blueButton.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    blueButton.BorderSizePixel = 0
    blueButton.Text = "-"
    blueButton.TextColor3 = self.Config.Theme.Text
    blueButton.Font = Enum.Font.GothamBold
    blueButton.TextSize = 24
    blueButton.TextStrokeTransparency = 0.5
    
    local blueCorner = Instance.new("UICorner", blueButton)
    blueCorner.CornerRadius = UDim.new(1, 0)
    
    local blueGradient = CreateAnimatedGradient(blueButton, {
        ColorSequenceKeypoint.new(0, Color3.fromRGB(50, 150, 255)),
        ColorSequenceKeypoint.new(0.3, Color3.fromRGB(100, 200, 255)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(150, 220, 255)),
        ColorSequenceKeypoint.new(0.7, Color3.fromRGB(80, 180, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(30, 100, 200))
    }, true)
    
    local blueGlow = CreateGlow(blueButton, Color3.fromRGB(50, 150, 255))
    
    local blueStroke = Instance.new("UIStroke", blueButton)
    blueStroke.Color = Color3.fromRGB(100, 180, 255)
    blueStroke.Thickness = 2
    blueStroke.Transparency = 0.3
    
    local blueStrokeGradient = Instance.new("UIGradient", blueStroke)
    blueStrokeGradient.Color = ColorSequence.new{
        ColorSequenceKeypoint.new(0, Color3.fromRGB(150, 200, 255)),
        ColorSequenceKeypoint.new(0.5, Color3.fromRGB(255, 255, 255)),
        ColorSequenceKeypoint.new(1, Color3.fromRGB(150, 200, 255))
    }
    
    -- Animação de pulsação dos brilhos
    local time = 0
    RunService.Heartbeat:Connect(function(dt)
        if not self.MainFrame or not self.MainFrame.Parent then return end
        
        time = time + dt
        
        -- Rotação dos gradientes das bordas
        redStrokeGradient.Rotation = (-time * 120) % 360
        blueStrokeGradient.Rotation = (-time * 120) % 360
        
        -- Pulsação dos brilhos
        local pulse = (math.sin(time * 3) + 1) / 2
        redGlow.ImageTransparency = 0.2 + (pulse * 0.3)
        blueGlow.ImageTransparency = 0.2 + (pulse * 0.3)
        
        local sizePulse = 1 + (math.sin(time * 2) * 0.05)
        redGlow.Size = UDim2.new(1.4 * sizePulse, 0, 1.4 * sizePulse, 0)
        blueGlow.Size = UDim2.new(1.4 * sizePulse, 0, 1.4 * sizePulse, 0)
    end)
    
    -- Efeitos de hover e clique
    self:AddButtonEffects(redButton, redStroke)
    self:AddButtonEffects(blueButton, blueStroke)
    
    -- Funcionalidade dos botões
    redButton.MouseButton1Click:Connect(function()
        self:Resize(50, 35)
    end)
    
    blueButton.MouseButton1Click:Connect(function()
        self:Resize(-50, -35)
    end)
end

-- Adicionar efeitos aos botões
function iLusiOS:AddButtonEffects(button, stroke)
    button.MouseEnter:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {Size = UDim2.new(0, 35, 0, 35)}):Play()
        TweenService:Create(stroke, TweenInfo.new(0.2), {Thickness = 3}):Play()
    end)
    
    button.MouseLeave:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.2), {Size = UDim2.new(0, 30, 0, 30)}):Play()
        TweenService:Create(stroke, TweenInfo.new(0.2), {Thickness = 2}):Play()
    end)
    
    button.MouseButton1Down:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.1), {Size = UDim2.new(0, 27, 0, 27)}):Play()
    end)
    
    button.MouseButton1Up:Connect(function()
        TweenService:Create(button, TweenInfo.new(0.1), {Size = UDim2.new(0, 30, 0, 30)}):Play()
    end)
end

-- Redimensionar janela
function iLusiOS:Resize(widthDelta, heightDelta)
    local newWidth = math.clamp(
        self.CurrentSize.X + widthDelta,
        self.Config.MinSize.X,
        self.Config.MaxSize.X
    )
    local newHeight = math.clamp(
        self.CurrentSize.Y + heightDelta,
        self.Config.MinSize.Y,
        self.Config.MaxSize.Y
    )
    
    self.CurrentSize = Vector2.new(newWidth, newHeight)
    
    TweenService:Create(
        self.MainFrame,
        TweenInfo.new(0.3, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
        {Size = UDim2.new(0, newWidth, 0, newHeight)}
    ):Play()
end

-- Animação de abertura
function iLusiOS:AnimateOpen()
    local tween = TweenService:Create(
        self.MainFrame,
        TweenInfo.new(0.45, Enum.EasingStyle.Quart, Enum.EasingDirection.Out),
        {
            Size = self.Config.Size,
            BackgroundTransparency = 0.4
        }
    )
    tween:Play()
end

-- Criar tab
function iLusiOS:AddTab(name)
    local tab = {
        Name = name,
        Content = Instance.new("Frame", self.Content),
        Buttons = {},
        Toggles = {},
        Sliders = {},
        Inputs = {}
    }
    
    tab.Content.Name = name
    tab.Content.Size = UDim2.new(1, 0, 0, 0)
    tab.Content.BackgroundTransparency = 1
    tab.Content.Visible = #self.Tabs == 0
    
    local layout = Instance.new("UIListLayout", tab.Content)
    layout.Padding = UDim.new(0, 8)
    layout.SortOrder = Enum.SortOrder.LayoutOrder
    
    layout:GetPropertyChangedSignal("AbsoluteContentSize"):Connect(function()
        tab.Content.Size = UDim2.new(1, 0, 0, layout.AbsoluteContentSize.Y)
    end)
    
    table.insert(self.Tabs, tab)
    
    if #self.Tabs == 1 then
        self.CurrentTab = tab
    end
    
    return setmetatable(tab, {__index = self})
end

-- Adicionar botão
function iLusiOS:AddButton(text, callback)
    local button = Instance.new("TextButton", self.Content)
    button.Size = UDim2.new(1, 0, 0, 35)
    button.BackgroundColor3 = self.Config.Theme.Primary
    button.BorderSizePixel = 0
    button.Text = text
    button.TextColor3 = self.Config.Theme.Text
    button.Font = Enum.Font.Gotham
    button.TextSize = 14
    
    local corner = Instance.new("UICorner", button)
    corner.CornerRadius = UDim.new(0, 8)
    
    local stroke = Instance.new("UIStroke", button)
    stroke.Color = self.Config.Theme.Accent
    stroke.Thickness = 1
    stroke.Transparency = 0.5
    
    button.MouseButton1Click:Connect(function()
        if callback then callback() end
    end)
    
    self:AddButtonEffects(button, stroke)
    
    return button
end

-- Adicionar toggle
function iLusiOS:AddToggle(text, default, callback)
    local container = Instance.new("Frame", self.Content)
    container.Size = UDim2.new(1, 0, 0, 35)
    container.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    container.BorderSizePixel = 0
    
    local corner = Instance.new("UICorner", container)
    corner.CornerRadius = UDim.new(0, 8)
    
    local label = Instance.new("TextLabel", container)
    label.Size = UDim2.new(1, -50, 1, 0)
    label.Position = UDim2.new(0, 10, 0, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = self.Config.Theme.Text
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    local toggle = Instance.new("TextButton", container)
    toggle.Size = UDim2.new(0, 40, 0, 20)
    toggle.Position = UDim2.new(1, -45, 0.5, -10)
    toggle.BackgroundColor3 = default and self.Config.Theme.Primary or Color3.fromRGB(60, 60, 65)
    toggle.Text = ""
    toggle.BorderSizePixel = 0
    
    local toggleCorner = Instance.new("UICorner", toggle)
    toggleCorner.CornerRadius = UDim.new(1, 0)
    
    local indicator = Instance.new("Frame", toggle)
    indicator.Size = UDim2.new(0, 16, 0, 16)
    indicator.Position = default and UDim2.new(1, -18, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)
    indicator.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
    indicator.BorderSizePixel = 0
    
    local indicatorCorner = Instance.new("UICorner", indicator)
    indicatorCorner.CornerRadius = UDim.new(1, 0)
    
    local state = default
    
    toggle.MouseButton1Click:Connect(function()
        state = not state
        
        TweenService:Create(
            toggle,
            TweenInfo.new(0.2),
            {BackgroundColor3 = state and self.Config.Theme.Primary or Color3.fromRGB(60, 60, 65)}
        ):Play()
        
        TweenService:Create(
            indicator,
            TweenInfo.new(0.2),
            {Position = state and UDim2.new(1, -18, 0.5, -8) or UDim2.new(0, 2, 0.5, -8)}
        ):Play()
        
        if callback then callback(state) end
    end)
    
    return container
end

-- Adicionar slider
function iLusiOS:AddSlider(text, min, max, default, callback)
    local container = Instance.new("Frame", self.Content)
    container.Size = UDim2.new(1, 0, 0, 50)
    container.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    container.BorderSizePixel = 0
    
    local corner = Instance.new("UICorner", container)
    corner.CornerRadius = UDim.new(0, 8)
    
    local label = Instance.new("TextLabel", container)
    label.Size = UDim2.new(1, -60, 0, 20)
    label.Position = UDim2.new(0, 10, 0, 5)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = self.Config.Theme.Text
    label.Font = Enum.Font.Gotham
    label.TextSize = 14
    label.TextXAlignment = Enum.TextXAlignment.Left
    
    local value = Instance.new("TextLabel", container)
    value.Size = UDim2.new(0, 50, 0, 20)
    value.Position = UDim2.new(1, -55, 0, 5)
    value.BackgroundTransparency = 1
    value.Text = tostring(default)
    value.TextColor3 = self.Config.Theme.Accent
    value.Font = Enum.Font.GothamBold
    value.TextSize = 14
    
    local sliderBg = Instance.new("Frame", container)
    sliderBg.Size = UDim2.new(1, -20, 0, 6)
    sliderBg.Position = UDim2.new(0, 10, 1, -15)
    sliderBg.BackgroundColor3 = Color3.fromRGB(50, 50, 55)
    sliderBg.BorderSizePixel = 0
    
    local sliderCorner = Instance.new("UICorner", sliderBg)
    sliderCorner.CornerRadius = UDim.new(1, 0)
    
    local sliderFill = Instance.new("Frame", sliderBg)
    sliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
    sliderFill.BackgroundColor3 = self.Config.Theme.Primary
    sliderFill.BorderSizePixel = 0
    
    local fillCorner = Instance.new("UICorner", sliderFill)
    fillCorner.CornerRadius = UDim.new(1, 0)
    
    local dragging = false
    
    local function update(input)
        local pos = math.clamp((input.Position.X - sliderBg.AbsolutePosition.X) / sliderBg.AbsoluteSize.X, 0, 1)
        local newValue = math.floor(min + (max - min) * pos)
        
        sliderFill.Size = UDim2.new(pos, 0, 1, 0)
        value.Text = tostring(newValue)
        
        if callback then callback(newValue) end
    end
    
    sliderBg.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = true
            update(input)
        end
    end)
    
    sliderBg.InputEnded:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 then
            dragging = false
        end
    end)
    
    UserInputService.InputChanged:Connect(function(input)
        if dragging and input.UserInputType == Enum.UserInputType.MouseMovement then
            update(input)
        end
    end)
    
    return container
end

-- Adicionar input de texto
function iLusiOS:AddInput(placeholder, callback)
    local input = Instance.new("TextBox", self.Content)
    input.Size = UDim2.new(1, 0, 0, 35)
    input.BackgroundColor3 = Color3.fromRGB(30, 30, 35)
    input.BorderSizePixel = 0
    input.PlaceholderText = placeholder
    input.Text = ""
    input.TextColor3 = self.Config.Theme.Text
    input.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
    input.Font = Enum.Font.Gotham
    input.TextSize = 14
    input.ClearTextOnFocus = false
    
    local corner = Instance.new("UICorner", input)
    corner.CornerRadius = UDim.new(0, 8)
    
    local stroke = Instance.new("UIStroke", input)
    stroke.Color = Color3.fromRGB(50, 50, 55)
    stroke.Thickness = 1
    
    input.Focused:Connect(function()
        TweenService:Create(stroke, TweenInfo.new(0.2), {Color = self.Config.Theme.Primary}):Play()
    end)
    
    input.FocusLost:Connect(function()
        TweenService:Create(stroke, TweenInfo.new(0.2), {Color = Color3.fromRGB(50, 50, 55)}):Play()
        if callback then callback(input.Text) end
    end)
    
    return input
end

-- Destruir UI
function iLusiOS:Destroy()
    if self.ScreenGui then
        self.ScreenGui:Destroy()
    end
end

return iLusiOS
